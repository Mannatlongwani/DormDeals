<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Product — DormDeals</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <!-- NAVBAR -->
  <div id="navbar-container"></div>

  <main class="container py-5" style="max-width:900px;">
    <div class="row g-4">
      <!-- Product Image -->
      <div class="col-md-6">
        <img id="productImage" src="/assets/placeholder.png" alt="Product image" 
             class="img-fluid rounded shadow-sm" 
             style="width:100%; height:360px; object-fit:cover;">
      </div>

      <!-- Product Info -->
      <div class="col-md-6">
        <h2 id="productName">Loading...</h2>
        <p class="h5 text-primary" id="productPrice"></p>

        <!-- Additional Details -->
        <ul class="list-group list-group-flush mt-3">
          <li class="list-group-item"><strong>Description:</strong> <span id="productDescription"></span></li>
          <li class="list-group-item"><strong>Category:</strong> <span id="productCategory"></span></li>
          <li class="list-group-item"><strong>Date Bought:</strong> <span id="productDate"></span></li>
        </ul>

        <!-- Seller Info -->

      </div>
      <hr/>
      <div class="col-md-6">
        <h4>Seller Info:</h4>
        <p>Name: <strong id="sellerName"></strong></p>
        <p>Email: <span id="sellerEmail"></span></p>
        <p>Phone: <span id="sellerPhone"></span></p>
      </div>

    </div>

  </main>

  <!-- FOOTER -->
  <div id="footer-container"></div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/main.js"></script>
  <script>
    renderNav();

    (async function () {
      const id = parseQueryParam("id");
      if (!id) {
        alert("Product id missing");
        window.location.href = "index.html";
        return;
      }
      try {
        const details = await loadProductDetails(id);
        const p = details.data;

        // Image with fallback
        document.getElementById("productImage").src = p.pimage || "/assets/placeholder.png";

        // Basic details
        document.getElementById("productName").textContent = p.pname || "Unnamed Product";
        document.getElementById("productPrice").textContent = p.pprice ? "₹" + p.pprice : "Price not specified";
        document.getElementById("productDescription").textContent = p.pdetail || "No description available.";

        // Additional details
        document.getElementById("productCategory").textContent = p.pcat || "Not specified";
        document.getElementById("productDate").textContent = p.pdate ? new Date(p.pdate).toLocaleDateString() : "Not specified";


        // Seller details
        document.getElementById("sellerName").textContent = details.name || "Unknown";
        document.getElementById("sellerEmail").textContent = details.mail || "Not provided";
        document.getElementById("sellerPhone").textContent = details.phone || "Not provided";
      } catch (err) {
        console.error(err);
        document.body.innerHTML = "<div class='container py-5 text-danger'>Failed to load product.</div>";
      }
    })();
  </script>
</body>
</html>
